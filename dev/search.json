[{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2020 2 Degrees Investing Initiative France Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/production-percent-change.html","id":"weighted-production","dir":"Articles","previous_headings":"","what":"Weighted Production","title":"Indicator Choices:","text":"intents purposes, recommend calculating targets using loan weighted production indicator. particular, define loan weighted production given company, \\(j\\) : \\[ \\overline{p}_{,j}(t) = p_{,j}(t) * \\dfrac{l_j}{\\sum_j l_j}\\] \\(p_{,j}\\) production company \\(\\) technology \\(j\\) \\(l_j\\) loan given company \\(j\\). calculate portfolio targets, aggregate value summing every company portfolio: \\[ \\overline{p}_i (t) = \\sum_j \\left[  p_{,j}(t) * \\dfrac{l_j}{\\sum_j l_j} \\right] \\] Effectively, loan-weighted average production attributed company portfolio. significant result indicator choice small companies (little production) favorably weighted, given loan company sufficiently large. can useful reflect large investments green start-ups. calculate weighted production:","code":"library(r2dii.data) library(r2dii.match) library(r2dii.analysis)  master <- loanbook_demo %>%   match_name(ald_demo) %>%   prioritize() %>%   join_ald_scenario(     ald = ald_demo,     scenario = scenario_demo_2020,     region_isos = region_isos_demo   )  summarize_weighted_production(master) #> # A tibble: 138 × 5 #>    sector_ald technology  year weighted_production weighted_technology_share #>    <chr>      <chr>      <int>               <dbl>                     <dbl> #>  1 automotive electric    2020             973775.                     0.114 #>  2 automotive electric    2021            1018967.                     0.118 #>  3 automotive electric    2022            1064159.                     0.122 #>  4 automotive electric    2023            1109351.                     0.126 #>  5 automotive electric    2024            1154543.                     0.130 #>  6 automotive electric    2025            1199735.                     0.133 #>  7 automotive electric    2026            1244926.                     0.137 #>  8 automotive hybrid      2020            1886042.                     0.221 #>  9 automotive hybrid      2021            1709634.                     0.198 #> 10 automotive hybrid      2022            1533226.                     0.176 #> # … with 128 more rows"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/production-percent-change.html","id":"weighted-percent-change-in-production","dir":"Articles","previous_headings":"","what":"Weighted Percent Change in Production","title":"Indicator Choices:","text":"-hand, ’re keen understand large corporations portfolio planning make significant changes, percent change production may useful indicator. company, define percent change, \\(\\chi_i(t)\\), compared start year, \\(t_0\\): \\[ \\chi_i(t) =  \\dfrac{p_{}(t)-p_{}(t_0)}{p_i(t_0)} * 100\\] \\(p_i(t)\\) indicator (production capacity) technology \\(\\), \\(t0\\) start year analysis. aggregate percent-change production company portfolio-level, using loan-weighted average . particular, loan \\(l_j\\) company \\(j\\), : \\[ \\overline{\\chi_i} = \\sum_j \\left[ \\chi_{,j} * \\dfrac{l_j}{\\sum_j l_j} \\right]\\] noted percent change, \\(\\chi\\), undefined 0 initial production. Intuitively, makes sense, since require “infinite percent” build-grow anything 0. reason, company 0 initial production filtered prior calculating percent change indicator. calculate weighted percent change:","code":"# using the master dataset defined in the previous chunk: summarize_weighted_percent_change(master) #> # A tibble: 138 × 4 #>    sector_ald technology  year weighted_percent_change #>    <chr>      <chr>      <int>                   <dbl> #>  1 automotive electric    2020                  0      #>  2 automotive electric    2021                  0.0881 #>  3 automotive electric    2022                  0.176  #>  4 automotive electric    2023                  0.264  #>  5 automotive electric    2024                  0.352  #>  6 automotive electric    2025                  0.440  #>  7 automotive electric    2026                  0.528  #>  8 automotive hybrid      2020                  1.78   #>  9 automotive hybrid      2021                  1.43   #> 10 automotive hybrid      2022                  1.09   #> # … with 128 more rows"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/r2dii-analysis.html","id":"load-your-r2dii-libraries","dir":"Articles","previous_headings":"","what":"Load your r2dii libraries","title":"Introduction to r2dii.analysis","text":"first step analysis load recommended r2dii packages current R session. r2dii.data includes fake data help demonstrate tool r2dii.match provides functions help easily match loanbook asset-level data. plot results, may also load package r2dii.plot. also recommend packages tidyverse; optional useful.","code":"library(r2dii.data) library(r2dii.match) library(r2dii.analysis) library(r2dii.plot) library(tidyverse) #> ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ── #> ✔ ggplot2 3.3.5     ✔ purrr   0.3.4 #> ✔ tibble  3.1.6     ✔ dplyr   1.0.8 #> ✔ tidyr   1.2.0     ✔ stringr 1.4.0 #> ✔ readr   2.1.2     ✔ forcats 0.5.1 #> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── #> ✖ dplyr::filter() masks stats::filter() #> ✖ dplyr::lag()    masks stats::lag()"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/r2dii-analysis.html","id":"match-your-loanbook-to-climate-related-asset-level-data","dir":"Articles","previous_headings":"","what":"Match your loanbook to climate-related asset-level data","title":"Introduction to r2dii.analysis","text":"See r2dii.match complete description process.","code":"# Use these datasets to practice but eventually you should use your own data. # The optional syntax `package::data` is to clarify where the data comes from. loanbook <- r2dii.data::loanbook_demo ald <- r2dii.data::ald_demo  matched <- match_name(loanbook, ald) %>% prioritize()  matched #> # A tibble: 217 × 28 #>    id_loan id_direct_loantak… name_direct_loa… id_intermediate… name_intermedia… #>    <chr>   <chr>              <chr>            <chr>            <chr>            #>  1 L6      C304               Yukon Developme… NA               NA               #>  2 L13     C297               Yuba City Cogen… NA               NA               #>  3 L20     C287               Ytl Powerseraya… NA               NA               #>  4 L21     C286               Ytl Power Inter… NA               NA               #>  5 L22     C285               Ytl Corp Bhd     NA               NA               #>  6 L23     C283               Ypic Internatio… NA               NA               #>  7 L24     C282               Ypfb Corporacion NA               NA               #>  8 L25     C281               Ypf Sa           NA               NA               #>  9 L26     C280               Ypf Energia Ele… NA               NA               #> 10 L27     C278               Younicos Ag      NA               NA               #> # … with 207 more rows, and 23 more variables: id_ultimate_parent <chr>, #> #   name_ultimate_parent <chr>, loan_size_outstanding <dbl>, #> #   loan_size_outstanding_currency <chr>, loan_size_credit_limit <dbl>, #> #   loan_size_credit_limit_currency <chr>, sector_classification_system <chr>, #> #   sector_classification_input_type <chr>, #> #   sector_classification_direct_loantaker <dbl>, fi_type <chr>, #> #   flag_project_finance_loan <chr>, name_project <lgl>, …"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/r2dii-analysis.html","id":"calculate-targets","dir":"Articles","previous_headings":"","what":"Calculate targets","title":"Introduction to r2dii.analysis","text":"can calculate scenario targets using two different approaches: Market Share Approach, Sectoral Decarbonization Approach.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/r2dii-analysis.html","id":"market-share-approach","dir":"Articles","previous_headings":"Calculate targets","what":"Market Share Approach","title":"Introduction to r2dii.analysis","text":"Market Share Approach used calculate scenario targets production technology sector. example, can use approach set targets production electric vehicles automotive sector. approach recommended sectors granular technology scenario roadmap exists. Targets can set portfolio level: company level:","code":"# Use these datasets to practice but eventually you should use your own data. scenario <- r2dii.data::scenario_demo_2020 regions <- r2dii.data::region_isos_demo  market_share_targets_portfolio <- matched %>%   target_market_share(     ald = ald,     scenario = scenario,     region_isos = regions   )  market_share_targets_portfolio #> # A tibble: 1,790 × 10 #>    sector     technology  year region scenario_source metric     production #>    <chr>      <chr>      <int> <chr>  <chr>           <chr>           <dbl> #>  1 automotive electric    2020 global demo_2020       projected     324592. #>  2 automotive electric    2020 global demo_2020       target_cps    324592. #>  3 automotive electric    2020 global demo_2020       target_sds    324592. #>  4 automotive electric    2020 global demo_2020       target_sps    324592. #>  5 automotive electric    2021 global demo_2020       projected     339656. #>  6 automotive electric    2021 global demo_2020       target_cps    329191. #>  7 automotive electric    2021 global demo_2020       target_sds    352505. #>  8 automotive electric    2021 global demo_2020       target_sps    330435. #>  9 automotive electric    2022 global demo_2020       projected     354720. #> 10 automotive electric    2022 global demo_2020       target_cps    333693. #> # … with 1,780 more rows, and 3 more variables: technology_share <dbl>, #> #   scope <chr>, percentage_of_initial_production_by_scope <dbl> market_share_targets_company <- matched %>%   target_market_share(     ald = ald,     scenario = scenario,     region_isos = regions,     # Output results at company-level.     by_company = TRUE    ) #> Warning: You've supplied `by_company = TRUE` and `weight_production = TRUE`. #> This will result in company-level results, weighted by the portfolio #> loan size, which is rarely useful. Did you mean to set one of these #> arguments to `FALSE`?  market_share_targets_company #> # A tibble: 32,402 × 11 #>    sector     technology  year region scenario_source name_ald metric production #>    <chr>      <chr>      <int> <chr>  <chr>           <chr>    <chr>       <dbl> #>  1 automotive electric    2020 global demo_2020       toyota … proje…    324592. #>  2 automotive electric    2020 global demo_2020       toyota … targe…    324592. #>  3 automotive electric    2020 global demo_2020       toyota … targe…    324592. #>  4 automotive electric    2020 global demo_2020       toyota … targe…    324592. #>  5 automotive electric    2021 global demo_2020       toyota … proje…    339656. #>  6 automotive electric    2021 global demo_2020       toyota … targe…    329191. #>  7 automotive electric    2021 global demo_2020       toyota … targe…    352505. #>  8 automotive electric    2021 global demo_2020       toyota … targe…    330435. #>  9 automotive electric    2022 global demo_2020       toyota … proje…    354720. #> 10 automotive electric    2022 global demo_2020       toyota … targe…    333693. #> # … with 32,392 more rows, and 3 more variables: technology_share <dbl>, #> #   scope <chr>, percentage_of_initial_production_by_scope <dbl>"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/r2dii-analysis.html","id":"sectoral-decarbonization-approach","dir":"Articles","previous_headings":"Calculate targets","what":"Sectoral Decarbonization Approach","title":"Introduction to r2dii.analysis","text":"Sectoral Decarbonization Approach used calculate scenario targets emission_factor sector. example, can use approach set targets average emission factor cement sector. approach recommended sectors lacking technology roadmaps.","code":"# Use this dataset to practice but eventually you should use your own data. co2 <- r2dii.data::co2_intensity_scenario_demo  sda_targets <- matched %>%   target_sda(ald = ald, co2_intensity_scenario = co2, region_isos = regions) %>%    filter(sector == \"cement\", year >= 2020) #> Warning: Removing ald rows where `emission_factor` is NA  sda_targets #> # A tibble: 110 × 6 #>    sector  year region         scenario_source emission_factor… emission_factor… #>    <chr>  <dbl> <chr>          <chr>           <chr>                       <dbl> #>  1 cement  2020 advanced econ… demo_2020       projected                  0.0230 #>  2 cement  2020 developing as… demo_2020       projected                  0.0595 #>  3 cement  2020 global         demo_2020       projected                  0.664  #>  4 cement  2021 advanced econ… demo_2020       projected                  0.0232 #>  5 cement  2021 developing as… demo_2020       projected                  0.0594 #>  6 cement  2021 global         demo_2020       projected                  0.665  #>  7 cement  2022 advanced econ… demo_2020       projected                  0.0233 #>  8 cement  2022 developing as… demo_2020       projected                  0.0592 #>  9 cement  2022 global         demo_2020       projected                  0.666  #> 10 cement  2023 advanced econ… demo_2020       projected                  0.0235 #> # … with 100 more rows"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/r2dii-analysis.html","id":"visualization","dir":"Articles","previous_headings":"","what":"Visualization","title":"Introduction to r2dii.analysis","text":"large variety possible visualizations stemming outputs target_market_share() target_sda(). , highlight couple common plots can easily created using r2dii.plot package.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/r2dii-analysis.html","id":"market-share-sector-level-technology-mix","dir":"Articles","previous_headings":"Visualization","what":"Market Share: Sector-level technology mix","title":"Introduction to r2dii.analysis","text":"market share output, can plot portfolio’s exposure various climate sensitive technologies (projected), compare corporate economy, various scenario targets.","code":"# Pick the targets you want to plot. data <- filter(   market_share_targets_portfolio,   scenario_source == \"demo_2020\",   sector == \"power\",   region == \"global\",   metric %in% c(\"projected\", \"corporate_economy\", \"target_sds\") )  # Plot the technology mix qplot_techmix(data) #> The `technology_share` values are plotted for extreme years. #> Do you want to plot different years? E.g. filter data with:`subset(data, year %in% c(2020, 2030))`."},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/r2dii-analysis.html","id":"market-share-technology-level-volume-trajectory","dir":"Articles","previous_headings":"Visualization","what":"Market Share: Technology-level volume trajectory","title":"Introduction to r2dii.analysis","text":"can also plot technology-specific volume trend. starting values normalized 1, emphasize comparing rates buildout /retirement.","code":"data <- filter(   market_share_targets_portfolio,   sector == \"power\",   technology == \"renewablescap\",   region == \"global\",   scenario_source == \"demo_2020\" )  qplot_trajectory(data) #> Normalizing `production` values to 2020 -- the start year."},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/r2dii-analysis.html","id":"sda-target","dir":"Articles","previous_headings":"Visualization","what":"SDA Target","title":"Introduction to r2dii.analysis","text":"SDA output, can compare projected average emission intensity attributed portfolio, actual emission intensity scenario, scenario compliant SDA pathway portfolio must follow achieve scenario ambition 2050.","code":"data <- filter(sda_targets, sector == \"cement\", region == \"global\") qplot_emission_intensity(data)"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/target-market-share.html","id":"scenario-market-shares","dir":"Articles","previous_headings":"","what":"Scenario market-shares","title":"Market Share Approach","text":"Say want study portfolio perform specific climate scenario. can allocate scenario efforts production profile portfolio? can two ways – technology, sector.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/target-market-share.html","id":"market-share-by-technology","dir":"Articles","previous_headings":"Scenario market-shares","what":"1. Market-share by technology","title":"Market Share Approach","text":"define market-share technology : \\[p_{}^{tmsr}(t) = p_{}(t_{0}) +  p_{}(t_{0}) * \\frac{s_i(t) - s_{}(t_0)}{s_i(t_0)}\\] can see reduces : \\[p_{}^{tmsr}(t) = p_{}(t_{0}) \\left(1 + \\frac{s_i(t) - s_{}(t_0)}{s_i(t_0)} \\right) \\\\ p_{}^{tmsr}(t) = p_{}(t_{0}) \\left(1 + \\frac{s_i(t)}{s_i(t_0)} -1 \\right) \\\\ p_{}^{tmsr}(t) = p_{}(t_{0}) * \\frac{s_i(t)}{s_i(t_0)}\\] : \\(s_i(t)\\) scenario production technology \\(\\) time \\(t\\), \\(p_{}(t_0)\\) production allocated portfolio technology, \\(\\) time \\(t_0\\), \\(p_{}^{tmsr}(t)\\) portfolio-specific target production technology. define “Technology Market Share Ratio” : \\[\\dfrac{s_i(t)}{s_i(t_0)}\\] method used set targets “decreasing” (ie. brown) technologies.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/target-market-share.html","id":"market-share-by-sector","dir":"Articles","previous_headings":"Scenario market-shares","what":"2. Market-share by sector","title":"Market Share Approach","text":"calculate market-share sector, use initial production portfolio scenario sector-level instead. \\[p_{}^{smsp}(t) = p_{}(t_0) +P(t_0) * \\left( \\dfrac{s_i(t)-s_i(t_0)}{S(t_0)}\\right)\\] : \\(P_i(t_0)\\) portfolio’s total production sector \\(t_0\\), \\(S(t_0)\\) scenario total production \\(t_0\\). define “Sector Market Share Percentage” : \\[\\dfrac{s_i(t)-s_i(t_0)}{S(t_0)}\\] method used calculate targets “increasing” (ie. green) technologies.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/target-market-share.html","id":"how-to-calculate-market-share-targets-for-a-given-scenario","dir":"Articles","previous_headings":"","what":"How to calculate market-share targets for a given scenario","title":"Market Share Approach","text":"calculate market-share targets, need use package r2dii.analysis number datasets. One datasets “matched” dataset (loanbook + asset-level data) can get package r2dii.match. datasets use come package r2dii.data; fake show structure data. Use packages. Match loanbook asset level data. Calculate market-share targets production portfolio level. Calculate market-share targets production company level.","code":"library(r2dii.data) library(r2dii.match) library(r2dii.analysis) loanbook <- r2dii.data::loanbook_demo ald <- r2dii.data::ald_demo  matched <- match_name(loanbook, ald) %>%   # WARNING: Remember to validate the output of match_name() before prioritize()   prioritize()  matched #> # A tibble: 217 × 28 #>    id_loan id_direct_loantak… name_direct_loa… id_intermediate… name_intermedia… #>    <chr>   <chr>              <chr>            <chr>            <chr>            #>  1 L6      C304               Yukon Developme… NA               NA               #>  2 L13     C297               Yuba City Cogen… NA               NA               #>  3 L20     C287               Ytl Powerseraya… NA               NA               #>  4 L21     C286               Ytl Power Inter… NA               NA               #>  5 L22     C285               Ytl Corp Bhd     NA               NA               #>  6 L23     C283               Ypic Internatio… NA               NA               #>  7 L24     C282               Ypfb Corporacion NA               NA               #>  8 L25     C281               Ypf Sa           NA               NA               #>  9 L26     C280               Ypf Energia Ele… NA               NA               #> 10 L27     C278               Younicos Ag      NA               NA               #> # … with 207 more rows, and 23 more variables: id_ultimate_parent <chr>, #> #   name_ultimate_parent <chr>, loan_size_outstanding <dbl>, #> #   loan_size_outstanding_currency <chr>, loan_size_credit_limit <dbl>, #> #   loan_size_credit_limit_currency <chr>, sector_classification_system <chr>, #> #   sector_classification_input_type <chr>, #> #   sector_classification_direct_loantaker <dbl>, fi_type <chr>, #> #   flag_project_finance_loan <chr>, name_project <lgl>, … # portfolio level targets scenario <- r2dii.data::scenario_demo_2020 regions <- r2dii.data::region_isos_demo   matched %>% target_market_share(ald, scenario, regions) #> # A tibble: 1,790 × 10 #>    sector     technology  year region scenario_source metric     production #>    <chr>      <chr>      <int> <chr>  <chr>           <chr>           <dbl> #>  1 automotive electric    2020 global demo_2020       projected     324592. #>  2 automotive electric    2020 global demo_2020       target_cps    324592. #>  3 automotive electric    2020 global demo_2020       target_sds    324592. #>  4 automotive electric    2020 global demo_2020       target_sps    324592. #>  5 automotive electric    2021 global demo_2020       projected     339656. #>  6 automotive electric    2021 global demo_2020       target_cps    329191. #>  7 automotive electric    2021 global demo_2020       target_sds    352505. #>  8 automotive electric    2021 global demo_2020       target_sps    330435. #>  9 automotive electric    2022 global demo_2020       projected     354720. #> 10 automotive electric    2022 global demo_2020       target_cps    333693. #> # … with 1,780 more rows, and 3 more variables: technology_share <dbl>, #> #   scope <chr>, percentage_of_initial_production_by_scope <dbl> matched %>% target_market_share(ald, scenario, regions, by_company = TRUE) #> Warning: You've supplied `by_company = TRUE` and `weight_production = TRUE`. #> This will result in company-level results, weighted by the portfolio #> loan size, which is rarely useful. Did you mean to set one of these #> arguments to `FALSE`? #> # A tibble: 32,402 × 11 #>    sector     technology  year region scenario_source name_ald metric production #>    <chr>      <chr>      <int> <chr>  <chr>           <chr>    <chr>       <dbl> #>  1 automotive electric    2020 global demo_2020       toyota … proje…    324592. #>  2 automotive electric    2020 global demo_2020       toyota … targe…    324592. #>  3 automotive electric    2020 global demo_2020       toyota … targe…    324592. #>  4 automotive electric    2020 global demo_2020       toyota … targe…    324592. #>  5 automotive electric    2021 global demo_2020       toyota … proje…    339656. #>  6 automotive electric    2021 global demo_2020       toyota … targe…    329191. #>  7 automotive electric    2021 global demo_2020       toyota … targe…    352505. #>  8 automotive electric    2021 global demo_2020       toyota … targe…    330435. #>  9 automotive electric    2022 global demo_2020       toyota … proje…    354720. #> 10 automotive electric    2022 global demo_2020       toyota … targe…    333693. #> # … with 32,392 more rows, and 3 more variables: technology_share <dbl>, #> #   scope <chr>, percentage_of_initial_production_by_scope <dbl>"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/target-sda.html","id":"sda-methodology","dir":"Articles","previous_headings":"","what":"SDA Methodology","title":"Sectoral Decarbonization Approach (SDA)","text":"Sectoral Decarbonization Approach (SDA) method setting corporate CO2 emissions intensity reduction targets line climate science. method developed Science-Based Targets Initiative (SBTI), international initiative science-based target setting companies initiated CDP, United Nations Global Compact, World Resources Institute (WRI), Worldwide Fund Nature (WWF). context PACTA, methodology used calculate emission factor targets homogenous sectors (.e. sectors technology-level scenario pathways). First, distance, \\(d\\), company’s CO2 emissions intensity per unit production (emissions factor), \\(^{Co}(t)\\) base year, \\(t_0\\), scenario target intensity 2050, \\(^{Sc}(2050)\\) calculated. target intensity 2050 can taken relevant climate scenario: \\[d = ^{Co}(t_0) - ^{Sc}(2050)\\] company’s market share parameter, \\(m(t)\\), defined company’s expected future activity, \\(P^{Co}(t)\\) divided sector’s future activity, \\(P^{Sc}(t)\\) reflect expected forward-looking market share company. given ratio company’s base year market share, derived activity, \\(P^{Co}(t_0)\\) divided sector’s activity year, \\(P^{Sc}(t_0)\\). cases former calculated per company, latter determined climate scenario: \\[m (t) = \\dfrac{P^{Co}(t_0) / P^{Sc}(t_0)}{P^{Co}(t) / P^{Sc}(t)}\\] noted parameter capture change market share company rather inverse. useful equates decreasing parameter company’s market share increasing. equates larger reduction efforts companies market share increasing time. sector decarbonization factor, \\(p(t)\\) defined : \\[ p(t) = \\frac{^{Sc}(t) - ^{Sc}(2050)}{^{Sc}(t_0) - ^{Sc}(2050)}\\] \\(^{}(t)\\) \\(^{Sc}(t)\\) average market scenario emission intensities respectively, time \\(t\\). variable captures remaining effort needed market meet target 2050, per year. SDA assumptions CO2 intensity companies sector converge 2050. Note \\(p(t_0) = 1\\) \\(p(2050) = 0\\), indicating 100% expected decarbonization efforts still met base year 0% left 2050. company-level emission intensity target defined : \\[^{Target}(t) = \\left( d * p (t) * m (t) \\right) + ^{Sc}(2050)\\]","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/target-sda.html","id":"pacta-assumptions","dir":"Articles","previous_headings":"","what":"PACTA Assumptions","title":"Sectoral Decarbonization Approach (SDA)","text":"SDA applied PACTA differs slightly way applied SBTI. particular, must align top-approach laid climate scenarios bottom-asset-level data used PACTA analysis. Assumption: Market share stays constant (\\(m(t)\\) = 1) Due lack quantitative data expected market share changes throughout entire time horizon 2050. \\(m(t)\\) set 1 years. SBTI method calculating \\(m(t)\\), higher intensity reduction target cases absolute pathway sector exceeds scenario target. makes sense. However, applying company level counter-intuitive: Companies decrease market share allowed higher CO2-Intensity average market actor. , companies increasing market share forced terms CO2-Intensity ones whose market share remains constant. follows company reaches targeted CO2-Intensity allowed increase share market. desirable outcome. assumption, target calculation reduces : \\[^{Target}(t) = \\left( d * p (t) \\right) + ^{Sc}(2050)\\] Approximation: Adjust base year scenario emission intensity SBTI PACTA methodology target emissions sector taken climate scenarios. implement global economy top-approach applies absolute emissions value year 2050 converts yearly emission intensities. However, may discrepancies Scenario projected emission intensities, bottom-ALD emission intensities. reflect discrepancy, adjust scenario projections following factor, \\[\\dfrac{^{ALD}(t_0)}{^{Sc}(t_0)}\\] yielding adjusted scenario pathway: \\['^{Sc}(t) = \\left(\\dfrac{^{ALD}(t_0)}{^{Sc}(t_0)}\\right) * ^{Sc}(t)\\] yields final PACTA SDA target equation: \\[^{Target}(t) = \\left( d * p (t) \\right) + '^{Sc}(t)\\] Note: \\(d\\) \\(p(t)\\) also must re-calculated using adjusted scenario intensity, \\('^{Sc}\\).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/articles/target-sda.html","id":"calculating-sda-targets","dir":"Articles","previous_headings":"","what":"Calculating SDA Targets","title":"Sectoral Decarbonization Approach (SDA)","text":"calculate SDA targets need use package r2dii.analysis number datasets, including “matched” dataset (loanbook + asset-level data) can get package r2dii.match. datasets use come package r2dii.data; fake show structure data. Use packages. Match loanbook asset level data. Calculate SDA targets CO2 emissions intensities:","code":"library(r2dii.data) library(r2dii.match) library(r2dii.analysis) loanbook <- r2dii.data::loanbook_demo ald <- r2dii.data::ald_demo  matched <- match_name(loanbook, ald) %>%   # WARNING: Remember to validate the output of match_name() before prioritize()   prioritize()  matched #> # A tibble: 217 × 28 #>    id_loan id_direct_loantak… name_direct_loa… id_intermediate… name_intermedia… #>    <chr>   <chr>              <chr>            <chr>            <chr>            #>  1 L6      C304               Yukon Developme… NA               NA               #>  2 L13     C297               Yuba City Cogen… NA               NA               #>  3 L20     C287               Ytl Powerseraya… NA               NA               #>  4 L21     C286               Ytl Power Inter… NA               NA               #>  5 L22     C285               Ytl Corp Bhd     NA               NA               #>  6 L23     C283               Ypic Internatio… NA               NA               #>  7 L24     C282               Ypfb Corporacion NA               NA               #>  8 L25     C281               Ypf Sa           NA               NA               #>  9 L26     C280               Ypf Energia Ele… NA               NA               #> 10 L27     C278               Younicos Ag      NA               NA               #> # … with 207 more rows, and 23 more variables: id_ultimate_parent <chr>, #> #   name_ultimate_parent <chr>, loan_size_outstanding <dbl>, #> #   loan_size_outstanding_currency <chr>, loan_size_credit_limit <dbl>, #> #   loan_size_credit_limit_currency <chr>, sector_classification_system <chr>, #> #   sector_classification_input_type <chr>, #> #   sector_classification_direct_loantaker <dbl>, fi_type <chr>, #> #   flag_project_finance_loan <chr>, name_project <lgl>, … co2_intensity <- r2dii.data::co2_intensity_scenario_demo  matched %>% target_sda(ald, co2_intensity) #> Warning: Removing ald rows where `emission_factor` is NA #> Warning: Found no matching regions for input scenario #> # A tibble: 0 × 4 #> # … with 4 variables: sector <chr>, year <int>, emission_factor_metric <chr>, #> #   emission_factor_value <dbl>"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jackson Hoffart. Author, maintainer. Mauro Lepore. Author, contractor. Klaus Hogedorn. Author. 2 Degrees Investing Initiative. Copyright holder, funder.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hoffart J, Lepore M, Hogedorn K (2022). r2dii.analysis: Measure Climate Scenario Alignment Corporate Loans. https://github.com/2DegreesInvesting/r2dii.analysis, https://2degreesinvesting.github.io/r2dii.analysis.","code":"@Manual{,   title = {r2dii.analysis: Measure Climate Scenario Alignment of Corporate Loans},   author = {Jackson Hoffart and Mauro Lepore and Klaus Hogedorn},   year = {2022},   note = {https://github.com/2DegreesInvesting/r2dii.analysis, https://2degreesinvesting.github.io/r2dii.analysis}, }"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/index.html","id":"r2diianalysis-","dir":"","previous_headings":"","what":"Measure Climate Scenario Alignment of Corporate Loans","title":"Measure Climate Scenario Alignment of Corporate Loans","text":"tools help assess financial portfolio aligns climate goals. summarize key metrics attributed portfolio (e.g. production, emission factors), calculate targets based climate scenarios. implement R last step free software ‘PACTA’ (Paris Agreement Capital Transition Assessment; https://2degrees-investing.org/). Financial institutions use ‘PACTA’ study capital allocation impacts climate.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Measure Climate Scenario Alignment of Corporate Loans","text":"Install released version r2dii.analysis CRAN : install development version r2dii.analysis GitHub : raise issue?","code":"install.packages(\"r2dii.analysis\") # install.packages(\"devtools\") devtools::install_github(\"2DegreesInvesting/r2dii.analysis\")"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Measure Climate Scenario Alignment of Corporate Loans","text":"Use library() attach packages need. r2dii.analysis depend packages r2dii.data r2dii.match; suggest install – install.packages(c(\"r2dii.data\", \"r2dii.match\")) – can reproduce examples. Use r2dii.match::match_name() identify matches loanbook asset level data.","code":"library(r2dii.data) library(r2dii.match) library(r2dii.analysis) matched <- match_name(loanbook_demo, ald_demo) %>%   prioritize()"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/index.html","id":"add-scenario-targets","dir":"","previous_headings":"Example","what":"Add Scenario Targets","title":"Measure Climate Scenario Alignment of Corporate Loans","text":"Use target_sda() calculate SDA targets CO2 emissions. Use target_market_share calculate market-share scenario targets portfolio level: company level:","code":"matched %>%   target_sda(     ald = ald_demo,     co2_intensity_scenario = co2_intensity_scenario_demo,     region_isos = region_isos_demo   ) #> Warning: Removing ald rows where `emission_factor` is NA #> # A tibble: 293 × 6 #>    sector  year region         scenario_source emission_factor… emission_factor… #>    <chr>  <dbl> <chr>          <chr>           <chr>                       <dbl> #>  1 cement  2013 advanced econ… demo_2020       projected                  0.0217 #>  2 cement  2013 developing as… demo_2020       projected                  0.0606 #>  3 cement  2013 global         demo_2020       projected                  0.658  #>  4 cement  2014 advanced econ… demo_2020       projected                  0.0219 #>  5 cement  2014 developing as… demo_2020       projected                  0.0604 #>  6 cement  2014 global         demo_2020       projected                  0.659  #>  7 cement  2015 advanced econ… demo_2020       projected                  0.0221 #>  8 cement  2015 developing as… demo_2020       projected                  0.0603 #>  9 cement  2015 global         demo_2020       projected                  0.660  #> 10 cement  2016 advanced econ… demo_2020       projected                  0.0223 #> # … with 283 more rows matched %>%   target_market_share(     ald = ald_demo,     scenario = scenario_demo_2020,     region_isos = region_isos_demo   ) #> # A tibble: 1,790 × 10 #>    sector     technology  year region scenario_source metric     production #>    <chr>      <chr>      <int> <chr>  <chr>           <chr>           <dbl> #>  1 automotive electric    2020 global demo_2020       projected     324592. #>  2 automotive electric    2020 global demo_2020       target_cps    324592. #>  3 automotive electric    2020 global demo_2020       target_sds    324592. #>  4 automotive electric    2020 global demo_2020       target_sps    324592. #>  5 automotive electric    2021 global demo_2020       projected     339656. #>  6 automotive electric    2021 global demo_2020       target_cps    329191. #>  7 automotive electric    2021 global demo_2020       target_sds    352505. #>  8 automotive electric    2021 global demo_2020       target_sps    330435. #>  9 automotive electric    2022 global demo_2020       projected     354720. #> 10 automotive electric    2022 global demo_2020       target_cps    333693. #> # … with 1,780 more rows, and 3 more variables: technology_share <dbl>, #> #   scope <chr>, percentage_of_initial_production_by_scope <dbl> matched %>%   target_market_share(     ald = ald_demo,     scenario = scenario_demo_2020,     region_isos = region_isos_demo,     by_company = TRUE   ) #> Warning: You've supplied `by_company = TRUE` and `weight_production = TRUE`. #> This will result in company-level results, weighted by the portfolio #> loan size, which is rarely useful. Did you mean to set one of these #> arguments to `FALSE`? #> # A tibble: 32,402 × 11 #>    sector     technology  year region scenario_source name_ald metric production #>    <chr>      <chr>      <int> <chr>  <chr>           <chr>    <chr>       <dbl> #>  1 automotive electric    2020 global demo_2020       toyota … proje…    324592. #>  2 automotive electric    2020 global demo_2020       toyota … targe…    324592. #>  3 automotive electric    2020 global demo_2020       toyota … targe…    324592. #>  4 automotive electric    2020 global demo_2020       toyota … targe…    324592. #>  5 automotive electric    2021 global demo_2020       toyota … proje…    339656. #>  6 automotive electric    2021 global demo_2020       toyota … targe…    329191. #>  7 automotive electric    2021 global demo_2020       toyota … targe…    352505. #>  8 automotive electric    2021 global demo_2020       toyota … targe…    330435. #>  9 automotive electric    2022 global demo_2020       toyota … proje…    354720. #> 10 automotive electric    2022 global demo_2020       toyota … targe…    333693. #> # … with 32,392 more rows, and 3 more variables: technology_share <dbl>, #> #   scope <chr>, percentage_of_initial_production_by_scope <dbl>"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/index.html","id":"utility-functions","dir":"","previous_headings":"Example","what":"Utility Functions","title":"Measure Climate Scenario Alignment of Corporate Loans","text":"target_*() functions provide shortcuts common operations. wrap utility functions may also use directly: Use join_ald_scenario() join matched dataset relevant scenario data, pick assets relevant regions. Use summarize_weighted_production() different grouping arguments calculate scenario-targets: Get started.","code":"loanbook_joined_to_ald_scenario <- matched %>%   join_ald_scenario(     ald = ald_demo,     scenario = scenario_demo_2020,     region_isos = region_isos_demo   ) # portfolio level loanbook_joined_to_ald_scenario %>%   summarize_weighted_production(scenario, tmsr, smsp, region) #> # A tibble: 702 × 9 #>    sector_ald technology  year scenario  tmsr    smsp region weighted_production #>    <chr>      <chr>      <int> <chr>    <dbl>   <dbl> <chr>                <dbl> #>  1 automotive electric    2020 cps       1    0       global             324592. #>  2 automotive electric    2020 sds       1    0       global             324592. #>  3 automotive electric    2020 sps       1    0       global             324592. #>  4 automotive electric    2021 cps       1.12 0.00108 global             339656. #>  5 automotive electric    2021 sds       1.16 0.00653 global             339656. #>  6 automotive electric    2021 sps       1.14 0.00137 global             339656. #>  7 automotive electric    2022 cps       1.24 0.00213 global             354720. #>  8 automotive electric    2022 sds       1.32 0.0131  global             354720. #>  9 automotive electric    2022 sps       1.29 0.00273 global             354720. #> 10 automotive electric    2023 cps       1.35 0.00316 global             369784. #> # … with 692 more rows, and 1 more variable: weighted_technology_share <dbl>  # company level loanbook_joined_to_ald_scenario %>%   summarize_weighted_production(scenario, tmsr, smsp, region, name_ald) #> # A tibble: 9,036 × 10 #>    sector_ald technology  year scenario  tmsr    smsp region name_ald          #>    <chr>      <chr>      <int> <chr>    <dbl>   <dbl> <chr>  <chr>             #>  1 automotive electric    2020 cps       1    0       global toyota motor corp #>  2 automotive electric    2020 sds       1    0       global toyota motor corp #>  3 automotive electric    2020 sps       1    0       global toyota motor corp #>  4 automotive electric    2021 cps       1.12 0.00108 global toyota motor corp #>  5 automotive electric    2021 sds       1.16 0.00653 global toyota motor corp #>  6 automotive electric    2021 sps       1.14 0.00137 global toyota motor corp #>  7 automotive electric    2022 cps       1.24 0.00213 global toyota motor corp #>  8 automotive electric    2022 sds       1.32 0.0131  global toyota motor corp #>  9 automotive electric    2022 sps       1.29 0.00273 global toyota motor corp #> 10 automotive electric    2023 cps       1.35 0.00316 global toyota motor corp #> # … with 9,026 more rows, and 2 more variables: weighted_production <dbl>, #> #   weighted_technology_share <dbl>"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Measure Climate Scenario Alignment of Corporate Loans","text":"project received funding European Union LIFE program International Climate Initiative (IKI). Federal Ministry Environment, Nature Conservation Nuclear Safety (BMU) supports initiative basis decision adopted German Bundestag. views expressed sole responsibility authors necessarily reflect views funders. funders responsible use may made information contains.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/join_ald_scenario.html","id":null,"dir":"Reference","previous_headings":"","what":"Join a data-loanbook object to the ald and scenario — join_ald_scenario","title":"Join a data-loanbook object to the ald and scenario — join_ald_scenario","text":"join_ald_scenario() simple wrapper several calls dplyr::join_*(), forming master dataset used later steps analysis.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/join_ald_scenario.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Join a data-loanbook object to the ald and scenario — join_ald_scenario","text":"","code":"join_ald_scenario(   data,   ald,   scenario,   region_isos = r2dii.data::region_isos,   add_green_technologies = FALSE )"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/join_ald_scenario.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Join a data-loanbook object to the ald and scenario — join_ald_scenario","text":"data data frame like output r2dii.match::prioritize. ald asset level data frame like r2dii.data::ald_demo. scenario scenario data frame like r2dii.data::scenario_demo_2020. region_isos data frame like r2dii.data::region_isos (default). add_green_technologies Logical vector length 1. FALSE defaults outputting technologies present data ald. Set FALSE add rows possible green technologies (0 production).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/join_ald_scenario.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Join a data-loanbook object to the ald and scenario — join_ald_scenario","text":"Returns fully joined data frame, linking portfolio, ald scenario.","code":""},{"path":[]},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/join_ald_scenario.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Join a data-loanbook object to the ald and scenario — join_ald_scenario","text":"","code":"installed <- requireNamespace(\"r2dii.data\", quietly = TRUE) &&   requireNamespace(\"r2dii.match\", quietly = TRUE)  if (installed) {   library(r2dii.data)   library(r2dii.match)    valid_matches <- match_name(loanbook_demo, ald_demo) %>%     # WARNING: Remember to validate matches (see `?prioritize`)     prioritize()    valid_matches %>%     join_ald_scenario(       ald = ald_demo,       scenario = scenario_demo_2020,       region_isos = region_isos_demo     ) } #> # A tibble: 9,099 × 45 #>    id_loan id_direct_loantak… name_direct_loa… id_intermediate… name_intermedia… #>    <chr>   <chr>              <chr>            <chr>            <chr>            #>  1 L6      C304               Yukon Developme… NA               NA               #>  2 L6      C304               Yukon Developme… NA               NA               #>  3 L6      C304               Yukon Developme… NA               NA               #>  4 L6      C304               Yukon Developme… NA               NA               #>  5 L6      C304               Yukon Developme… NA               NA               #>  6 L6      C304               Yukon Developme… NA               NA               #>  7 L6      C304               Yukon Developme… NA               NA               #>  8 L6      C304               Yukon Developme… NA               NA               #>  9 L6      C304               Yukon Developme… NA               NA               #> 10 L6      C304               Yukon Developme… NA               NA               #> # … with 9,089 more rows, and 40 more variables: id_ultimate_parent <chr>, #> #   name_ultimate_parent <chr>, loan_size_outstanding <dbl>, #> #   loan_size_outstanding_currency <chr>, loan_size_credit_limit <dbl>, #> #   loan_size_credit_limit_currency <chr>, sector_classification_system <chr>, #> #   sector_classification_input_type <chr>, #> #   sector_classification_direct_loantaker <dbl>, fi_type <chr>, #> #   flag_project_finance_loan <chr>, name_project <lgl>, …"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/r2dii.analysis-package.html","id":null,"dir":"Reference","previous_headings":"","what":"r2dii.analysis: Measure Climate Scenario Alignment of Corporate Loans — r2dii.analysis-package","title":"r2dii.analysis: Measure Climate Scenario Alignment of Corporate Loans — r2dii.analysis-package","text":"tools help assess corporate lending portfolio aligns climate goals. summarize key climate indicators attributed portfolio (e.g. production, emission factors), calculate alignment targets based climate scenarios. implement R last step free software 'PACTA' (Paris Agreement Capital Transition Assessment; <https://2degrees-investing.org/>). Financial institutions use 'PACTA' study capital allocation decisions align climate change mitigation goals.","code":""},{"path":[]},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/r2dii.analysis-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"r2dii.analysis: Measure Climate Scenario Alignment of Corporate Loans — r2dii.analysis-package","text":"Maintainer: Jackson Hoffart jackson.hoffart@gmail.com (ORCID) Authors: Mauro Lepore maurolepore@gmail.com (ORCID) [contractor] Klaus Hogedorn klaus@2degrees-investing.org contributors: 2 Degrees Investing Initiative contact@2degrees-investing.org [copyright holder, funder]","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/summarize_weighted_production.html","id":null,"dir":"Reference","previous_headings":"","what":"Summaries based on the weight of each loan per sector per year — summarize_weighted_production","title":"Summaries based on the weight of each loan per sector per year — summarize_weighted_production","text":"Based weight loan per sector per year, summarize_weighted_production() summarize_weighted_percent_change() summarize production percent-change, respectively.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/summarize_weighted_production.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summaries based on the weight of each loan per sector per year — summarize_weighted_production","text":"","code":"summarize_weighted_production(data, ..., use_credit_limit = FALSE)  summarize_weighted_percent_change(data, ..., use_credit_limit = FALSE)"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/summarize_weighted_production.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summaries based on the weight of each loan per sector per year — summarize_weighted_production","text":"data data frame like output join_ald_scenario(). ... Variables group . use_credit_limit Logical vector length 1. FALSE defaults using column loan_size_outstanding. Set TRUE instead use column loan_size_credit_limit.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/summarize_weighted_production.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summaries based on the weight of each loan per sector per year — summarize_weighted_production","text":"tibble groups input () columns: sector, technology, year; weighted_production weighted_production summarize_weighted_production() summarize_weighted_percent_change(), respectively.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/summarize_weighted_production.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Summaries based on the weight of each loan per sector per year — summarize_weighted_production","text":"percent-change analysis excludes companies 0 production. percent-change undefined companies initial production; including companies cause percent-change percentage infinite, wrong.","code":""},{"path":[]},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/summarize_weighted_production.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summaries based on the weight of each loan per sector per year — summarize_weighted_production","text":"","code":"installed <- requireNamespace(\"r2dii.data\", quietly = TRUE) &&   requireNamespace(\"r2dii.match\", quietly = TRUE) if (installed) {   library(r2dii.data)   library(r2dii.match)    loanbook <- head(loanbook_demo, 150)   ald <- head(ald_demo, 100)   master <- loanbook %>%     match_name(ald) %>%     prioritize() %>%     join_ald_scenario(       ald = ald,       scenario = scenario_demo_2020,       region_isos = region_isos_demo     )    summarize_weighted_production(master)    summarize_weighted_production(master, use_credit_limit = TRUE)    summarize_weighted_percent_change(master)    summarize_weighted_percent_change(master, use_credit_limit = TRUE) } #> # A tibble: 42 × 4 #>    sector_ald technology  year weighted_percent_change #>    <chr>      <chr>      <int>                   <dbl> #>  1 power      hydrocap    2020                   0     #>  2 power      hydrocap    2021                  -0.663 #>  3 power      hydrocap    2022                  -1.33  #>  4 power      hydrocap    2023                  -1.99  #>  5 power      hydrocap    2024                  -2.65  #>  6 power      hydrocap    2025                  -3.32  #>  7 power      hydrocap    2026                  -3.98  #>  8 power      hydrocap    2027                  -4.64  #>  9 power      hydrocap    2028                  -5.31  #> 10 power      hydrocap    2029                  -5.97  #> # … with 32 more rows"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_market_share.html","id":null,"dir":"Reference","previous_headings":"","what":"Add targets for production, using the market share approach — target_market_share","title":"Add targets for production, using the market share approach — target_market_share","text":"function calculates portfolio-level production targets, calculated using market share approach applied relevant climate production forecast.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_market_share.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add targets for production, using the market share approach — target_market_share","text":"","code":"target_market_share(   data,   ald,   scenario,   region_isos = r2dii.data::region_isos,   use_credit_limit = FALSE,   by_company = FALSE,   weight_production = TRUE )"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_market_share.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add targets for production, using the market share approach — target_market_share","text":"data \"data.frame\" like output r2dii.match::prioritize. ald asset level data frame like r2dii.data::ald_demo. scenario scenario data frame like r2dii.data::scenario_demo_2020. region_isos data frame like r2dii.data::region_isos (default). use_credit_limit Logical vector length 1. FALSE defaults using column loan_size_outstanding. Set TRUE use column loan_size_credit_limit instead. by_company Logical vector length 1. FALSE defaults outputting production_value portfolio-level. Set TRUE output production_value company-level. weight_production Logical vector length 1. TRUE defaults outputting production, weighted relative loan-size. Set FALSE output unweighted production values.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_market_share.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add targets for production, using the market share approach — target_market_share","text":"tibble including summarized columns metric, production, technology_share, percentage_of_initial_production_by_scope scope. by_company = TRUE, output also column name_ald.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_market_share.html","id":"handling-grouped-data","dir":"Reference","previous_headings":"","what":"Handling grouped data","title":"Add targets for production, using the market share approach — target_market_share","text":"function ignores existing groups outputs ungrouped data.","code":""},{"path":[]},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_market_share.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add targets for production, using the market share approach — target_market_share","text":"","code":"installed <- requireNamespace(\"r2dii.data\", quietly = TRUE) &&   requireNamespace(\"r2dii.match\", quietly = TRUE)  if (installed) {   library(r2dii.data)   library(r2dii.match)    loanbook <- head(loanbook_demo, 100)   ald <- head(ald_demo, 100)    matched <- loanbook %>%     match_name(ald) %>%     prioritize()    # Calculate targets at portfolio level   matched %>%     target_market_share(       ald = ald,       scenario = scenario_demo_2020,       region_isos = region_isos_demo     )    # Calculate targets at company level   matched %>%     target_market_share(       ald = ald,       scenario = scenario_demo_2020,       region_isos = region_isos_demo,       by_company = TRUE     )    matched %>%     target_market_share(       ald = ald,       scenario = scenario_demo_2020,       region_isos = region_isos_demo,       # Calculate unweighted targets       weight_production = FALSE     ) } #> Warning: You've supplied `by_company = TRUE` and `weight_production = TRUE`. #> This will result in company-level results, weighted by the portfolio #> loan size, which is rarely useful. Did you mean to set one of these #> arguments to `FALSE`? #> # A tibble: 315 × 10 #>    sector technology  year region scenario_source metric     production #>    <chr>  <chr>      <int> <chr>  <chr>           <chr>           <dbl> #>  1 power  hydrocap    2020 global demo_2020       projected     121032. #>  2 power  hydrocap    2020 global demo_2020       target_cps    121032. #>  3 power  hydrocap    2020 global demo_2020       target_sds    121032. #>  4 power  hydrocap    2020 global demo_2020       target_sps    121032. #>  5 power  hydrocap    2021 global demo_2020       projected     119274. #>  6 power  hydrocap    2021 global demo_2020       target_cps    121141. #>  7 power  hydrocap    2021 global demo_2020       target_sds    121205. #>  8 power  hydrocap    2021 global demo_2020       target_sps    121151. #>  9 power  hydrocap    2022 global demo_2020       projected     117515. #> 10 power  hydrocap    2022 global demo_2020       target_cps    121250. #> # … with 305 more rows, and 3 more variables: technology_share <dbl>, #> #   scope <chr>, percentage_of_initial_production_by_scope <dbl>"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_sda.html","id":null,"dir":"Reference","previous_headings":"","what":"Add targets for CO2 emissions per unit production at the portfolio level,\nusing the SDA approach — target_sda","title":"Add targets for CO2 emissions per unit production at the portfolio level,\nusing the SDA approach — target_sda","text":"function calculates targets CO2 emissions per unit production portfolio-level, otherwise referred \"emissions factors\". uses sectoral-decarbonization approach (SDA) calculate targets.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_sda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add targets for CO2 emissions per unit production at the portfolio level,\nusing the SDA approach — target_sda","text":"","code":"target_sda(   data,   ald,   co2_intensity_scenario,   use_credit_limit = FALSE,   by_company = FALSE,   region_isos = r2dii.data::region_isos )"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_sda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add targets for CO2 emissions per unit production at the portfolio level,\nusing the SDA approach — target_sda","text":"data dataframe like output r2dii.match::prioritize(). ald asset-level data frame like r2dii.data::ald_demo. co2_intensity_scenario scenario data frame like r2dii.data::co2_intensity_scenario_demo. use_credit_limit Logical vector length 1. FALSE defaults using column loan_size_outstanding. Set TRUE instead use column loan_size_credit_limit. by_company Logical vector length 1. FALSE defaults outputting weighted_production_value portfolio-level. Set TRUE output weighted_production_value company-level. region_isos data frame like r2dii.data::region_isos (default).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_sda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add targets for CO2 emissions per unit production at the portfolio level,\nusing the SDA approach — target_sda","text":"tibble including summarized columns emission_factor_metric emission_factor_value. by_company = TRUE, output also column name_ald.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_sda.html","id":"handling-grouped-data","dir":"Reference","previous_headings":"","what":"Handling grouped data","title":"Add targets for CO2 emissions per unit production at the portfolio level,\nusing the SDA approach — target_sda","text":"function ignores existing groups outputs ungrouped data.","code":""},{"path":[]},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/target_sda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add targets for CO2 emissions per unit production at the portfolio level,\nusing the SDA approach — target_sda","text":"","code":"installed <- requireNamespace(\"r2dii.match\", quietly = TRUE) &&   requireNamespace(\"r2dii.data\", quietly = TRUE)  if (installed) {   library(r2dii.match)   library(r2dii.data)    loanbook <- head(loanbook_demo, 150)   ald <- head(ald_demo, 100)    matched <- loanbook %>%     match_name(ald) %>%     prioritize()    # Calculate targets at portfolio level   matched %>%     target_sda(       ald = ald,       co2_intensity_scenario = co2_intensity_scenario_demo,       region_isos = region_isos_demo     )    # Calculate targets at company level   matched %>%     target_sda(       ald = ald,       co2_intensity_scenario = co2_intensity_scenario_demo,       region_isos = region_isos_demo,       by_company = TRUE     ) } #> Warning: Removing ald rows where `emission_factor` is NA #> Warning: Removing ald rows where `emission_factor` is NA #> # A tibble: 75 × 7 #>    sector  year region scenario_source emission_factor_metric emission_factor_v… #>    <chr>  <dbl> <chr>  <chr>           <chr>                               <dbl> #>  1 cement  2013 global demo_2020       corporate_economy                   0.643 #>  2 cement  2014 global demo_2020       corporate_economy                   0.654 #>  3 cement  2015 global demo_2020       corporate_economy                   0.666 #>  4 cement  2016 global demo_2020       corporate_economy                   0.677 #>  5 cement  2017 global demo_2020       corporate_economy                   0.689 #>  6 cement  2018 global demo_2020       corporate_economy                   0.700 #>  7 cement  2019 global demo_2020       corporate_economy                   0.712 #>  8 cement  2020 global demo_2020       corporate_economy                   0.723 #>  9 cement  2021 global demo_2020       corporate_economy                   0.735 #> 10 cement  2022 global demo_2020       corporate_economy                   0.746 #> # … with 65 more rows, and 1 more variable: name_ald <chr>"},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/tidyeval.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy eval helpers — tidyeval","title":"Tidy eval helpers — tidyeval","text":"learn tidy eval use tools, visit https://tidyeval.tidyverse.org Metaprogramming section Advanced R.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/reference/tidyeval.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy eval helpers — tidyeval","text":"sym() creates symbol string syms() creates list symbols character vector. enquo() enquos() delay execution one several function arguments. enquo() returns single quoted expression, like blueprint delayed computation. enquos() returns list quoted expressions. expr() quotes new expression locally. mostly useful build new expressions around arguments captured enquo() enquos(): expr(mean(!!enquo(arg), na.rm = TRUE)). as_name() transforms quoted variable name string. Supplying something else quoted variable name error. unlike as_label() also returns single string supports kind R object input, including quoted function calls vectors. purpose summarise object single label. label often suitable default name. know quoted expression contains (instance expressions captured enquo() variable name, call function, unquoted constant), use as_label(). know quoted simple variable name, like enforce , use as_name().","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-development-version","dir":"Changelog","previous_headings":"","what":"r2dii.analysis (development version)","title":"r2dii.analysis (development version)","text":"target_sda() now outputs unweighted emission_factor by_company TRUE (#376). target_sda() gains region_isos argument (#323). target_market_share() now outputs values years ald scenario inputs (#394). target_market_share() now outputs two new columns, percentage_of_initial_production_by_scope scope (ADO #4143).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-0112","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.12","title":"r2dii.analysis 0.1.12","text":"CRAN release: 2021-08-18 target_market_share() now outputs 0 technology_share, companies 0 sectoral production (#306 @Antoine-Lalechere). target_sda() now filters scenario start year consistent ald start year (#346 @waltjl).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-0110","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.10","title":"r2dii.analysis 0.1.10","text":"CRAN release: 2021-07-09 target_market_share() now sets negative smsp targets zero (#336). target_market_share() now outputs sectors present input datasets (#329). target_market_share() now always adds targets green technologies (defined r2dii.data::green_or_brown), even present input data (#318 @Antoine-Lalechere). target_market_share() now correctly groups region calculating technology_share (#315 @Antoine-Lalechere).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-019","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.9","title":"r2dii.analysis 0.1.9","text":"CRAN release: 2021-06-30 target_sda() now outputs sector values present input co2_intensity_scenario data (#308). target_sda() now outputs targets range years input co2_intenstiy_scenario (#307).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-018","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.8","title":"r2dii.analysis 0.1.8","text":"CRAN release: 2021-05-22 target_market_share() now correctly outputs target technology share, line methodology (@georgeharris2deg #277). target_market_share() now correctly projects technology share ‘production / total production’ computing company, unweighted relative loan size (@KapitanKombajn #288). target_market_share() longer outputs columns sector_weighted_production technology_weighted_production. columns internal shouldn’t face users (#291).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-016","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.6","title":"r2dii.analysis 0.1.6","text":"CRAN release: 2021-03-10 target_market_share() now correctly outputs technology_share multiple loans different level company (@ab-bbva #265).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-015","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.5","title":"r2dii.analysis 0.1.5","text":"CRAN release: 2021-01-22 target_market_share() now errors input data unexpected column (@georgeharris2deg #267). target_market_share() now correctly outputs technology_share multiple loans company (@georgeharris2deg #262, @ab-bbva #265).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-014","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.4","title":"r2dii.analysis 0.1.4","text":"CRAN release: 2021-01-05 target_market_share() now correctly outputs unweighted production company, equal ald-production one company multiple loans different size (#255 @georgeharris2deg).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-013","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.3","title":"r2dii.analysis 0.1.3","text":"CRAN release: 2020-12-15 target_market_share() now correctly outputs unweighted production multiple levels exist company (#249).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-012","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.2","title":"r2dii.analysis 0.1.2","text":"CRAN release: 2020-12-05 target_market_share() now outputs weighted_technology_share correctly sums 1 grouped sector, metric scenario (#218). target_market_share() now correctly outputs unweighted production multiple loans exist company (#239). target_market_share() now outputs empty named tibble matching region definitions can found (#236). target_market_share now outputs technologies present ald, even present data (#235). target_sda() now interpolates input scenario file year correctly calculates target, regardless time-horizon ald (#234). Hyperlinks “Get Started” tab website now points correct links (#222 @apmanning). Depend dplyr >= 0.8.5, explicitly. commit version newer dplyr 1 still relatively new, represents major change users initially resist. Relax dependency rlang, mostly driven dynamically recursive dependencies. example, dplyr 0.8.5 depends specific version rlang recent version explicitly depended – suggests explicit rlang unhelpful misleading. New internal data loanbook_stable region_isos_stable make regression tests stable (#227).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-011","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.1","title":"r2dii.analysis 0.1.1","text":"CRAN release: 2020-09-12 Change license MIT. website’s home page now thanks founders. target_market_share() now works expected value column scenario missing value column region. longer results output columns production technology_share type “list” (#203). website now shows News tab.","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-010","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.1.0","title":"r2dii.analysis 0.1.0","text":"CRAN release: 2020-09-03 target_sda() now correctly handles differing country_of_domicile inputs (#171). target_market_share() now outputs technology_share (#184). join_ald_scenario() now returns visibly dev-magrittr (#188 @lionel-). target_market_share() gains weight_production parameter (#181). target_market_share() now correctly use sector_ald column input data argument (#178). target_sda() now automatically filters ald rows emissions_factor values NA (#173). join_ald_scenario() now converts lower case values columns sector_ald technology (#172). target_sda() now aggregates input ald technology plant_location prior calculating targets (@QianFeng2020 #160). target_sda() now errors input data duplicated id_loan (@QianFeng2020 #164). target_sda() gains by_company parameter (#155). target_market_share() now outputs actual aggregated corporate economy. Previously, output , erroneously, normalized starting portfolio value (#158). target_sda() now correctly calculates SDA targets (#153): Targets now calculated using scenario data adjusted corporate economy data. adjusted scenario data also output function along usual metrics. Methodology error fixed, reflected code. Previously, target , incorrectly, calculated multiplying adjusted scenario. Now scenario data added instead. New summarize_weighted_percent_change() allows user calculate new indicator (#141). target_market_share() longer errors combination sector scenario_target_value uniquely identify observation (@georgeharris2deg #142).","code":""},{"path":"https://2degreesinvesting.github.io/r2dii.analysis/dev/news/index.html","id":"r2diianalysis-001","dir":"Changelog","previous_headings":"","what":"r2dii.analysis 0.0.1","title":"r2dii.analysis 0.0.1","text":"CRAN release: 2020-06-28 First release CRAN","code":""}]
